<svg viewBox="0 0 700 550" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse">
      <path d="M 20 0 L 0 0 0 20" fill="none" stroke="#e5e5e5" stroke-width="0.5"/>
    </pattern>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <path d="M0,0 L0,6 L9,3 z" fill="#666"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="700" height="550" fill="#fafafa"/>
  <rect width="700" height="550" fill="url(#grid)"/>

  <!-- Title -->
  <text x="40" y="35" font-family="monospace" font-size="14" fill="#333" font-weight="bold">Session Content Extraction</text>
  <text x="260" y="35" font-family="monospace" font-size="12" fill="#888">[ JSONL_TO_SEARCHABLE_MARKDOWN ]</text>

  <!-- Source: JSONL -->
  <rect x="50" y="70" width="200" height="120" fill="#fff" stroke="#e74c3c" stroke-width="2" rx="4"/>
  <text x="150" y="95" font-family="monospace" font-size="10" fill="#e74c3c" text-anchor="middle" font-weight="bold">session.jsonl</text>
  <text x="150" y="115" font-family="monospace" font-size="8" fill="#666" text-anchor="middle">Raw Claude Code transcript</text>

  <text x="70" y="140" font-family="monospace" font-size="7" fill="#999">{"type":"user","message":...}</text>
  <text x="70" y="152" font-family="monospace" font-size="7" fill="#999">{"type":"assistant",...}</text>
  <text x="70" y="164" font-family="monospace" font-size="7" fill="#999">{"type":"summary",...}</text>
  <text x="70" y="176" font-family="monospace" font-size="7" fill="#999">+ thinking blocks</text>

  <!-- Arrow down -->
  <line x1="150" y1="190" x2="150" y2="230" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="160" y="215" font-family="monospace" font-size="8" fill="#9b59b6">sync-sessions-to-qmd.sh</text>

  <!-- Extraction steps -->
  <rect x="50" y="240" width="600" height="180" fill="none" stroke="#9b59b6" stroke-width="2" stroke-dasharray="5,3" rx="4"/>
  <text x="65" y="260" font-family="monospace" font-size="10" fill="#9b59b6" font-weight="bold">EXTRACTION PIPELINE</text>

  <!-- Extract functions -->
  <rect x="70" y="280" width="120" height="45" fill="#f3e5f5" stroke="#9b59b6" stroke-width="1" rx="3"/>
  <text x="130" y="300" font-family="monospace" font-size="8" fill="#9b59b6" text-anchor="middle">extract_summary()</text>
  <text x="130" y="315" font-family="monospace" font-size="7" fill="#666" text-anchor="middle">title/summary</text>

  <rect x="210" y="280" width="120" height="45" fill="#f3e5f5" stroke="#9b59b6" stroke-width="1" rx="3"/>
  <text x="270" y="300" font-family="monospace" font-size="8" fill="#9b59b6" text-anchor="middle">extract_user_prompts()</text>
  <text x="270" y="315" font-family="monospace" font-size="7" fill="#666" text-anchor="middle">user questions</text>

  <rect x="350" y="280" width="120" height="45" fill="#f3e5f5" stroke="#9b59b6" stroke-width="1" rx="3"/>
  <text x="410" y="300" font-family="monospace" font-size="8" fill="#9b59b6" text-anchor="middle">extract_thinking()</text>
  <text x="410" y="315" font-family="monospace" font-size="7" fill="#666" text-anchor="middle">reasoning/analysis</text>

  <rect x="490" y="280" width="120" height="45" fill="#f3e5f5" stroke="#9b59b6" stroke-width="1" rx="3"/>
  <text x="550" y="300" font-family="monospace" font-size="8" fill="#9b59b6" text-anchor="middle">extract_key_actions()</text>
  <text x="550" y="315" font-family="monospace" font-size="7" fill="#666" text-anchor="middle">files/commands</text>

  <!-- Assistant insights -->
  <rect x="210" y="345" width="240" height="45" fill="#f3e5f5" stroke="#9b59b6" stroke-width="1" rx="3"/>
  <text x="330" y="365" font-family="monospace" font-size="8" fill="#9b59b6" text-anchor="middle">extract_assistant_insights()</text>
  <text x="330" y="380" font-family="monospace" font-size="7" fill="#666" text-anchor="middle">explanations, solutions, plans</text>

  <!-- Arrow down -->
  <line x1="350" y1="420" x2="350" y2="460" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Output: Markdown -->
  <rect x="200" y="470" width="300" height="60" fill="#e8f5e9" stroke="#27ae60" stroke-width="2" rx="4"/>
  <text x="350" y="495" font-family="monospace" font-size="10" fill="#27ae60" text-anchor="middle" font-weight="bold">project/session-id.md</text>
  <text x="350" y="515" font-family="monospace" font-size="8" fill="#666" text-anchor="middle">Searchable markdown with frontmatter</text>

  <!-- What's in the markdown -->
  <rect x="520" y="70" width="150" height="170" fill="#e8f5e9" stroke="#27ae60" stroke-width="1.5" rx="4"/>
  <text x="595" y="95" font-family="monospace" font-size="9" fill="#27ae60" text-anchor="middle" font-weight="bold">Output Structure</text>

  <text x="535" y="120" font-family="monospace" font-size="7" fill="#666">---</text>
  <text x="535" y="132" font-family="monospace" font-size="7" fill="#666">session_id: uuid</text>
  <text x="535" y="144" font-family="monospace" font-size="7" fill="#666">project: name</text>
  <text x="535" y="156" font-family="monospace" font-size="7" fill="#666">---</text>
  <text x="535" y="172" font-family="monospace" font-size="7" fill="#27ae60"># Title (summary)</text>
  <text x="535" y="184" font-family="monospace" font-size="7" fill="#27ae60">## Key Actions</text>
  <text x="535" y="196" font-family="monospace" font-size="7" fill="#27ae60">## Conversation</text>
  <text x="535" y="208" font-family="monospace" font-size="7" fill="#27ae60">## Key Insights</text>
  <text x="535" y="220" font-family="monospace" font-size="7" fill="#27ae60">## Problem Analysis</text>

  <!-- Arrow from markdown to output -->
  <path d="M 520 180 L 450 180 Q 400 180 350 210 L 250 240" fill="none" stroke="#27ae60" stroke-width="1" stroke-dasharray="3,2"/>

  <!-- Bottom note -->
  <text x="350" y="540" font-family="monospace" font-size="9" fill="#999" text-anchor="middle">Rich content extraction enables semantic search across all past sessions</text>
</svg>